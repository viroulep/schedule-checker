(this["webpackJsonpschedule-checker"]=this["webpackJsonpschedule-checker"]||[]).push([[0],{358:function(e,t,a){e.exports=a(652)},368:function(e,t){},370:function(e,t){},402:function(e,t){},403:function(e,t){},453:function(e,t,a){},577:function(e,t,a){},646:function(e,t,a){},647:function(e,t,a){},648:function(e,t,a){},649:function(e,t,a){},650:function(e,t,a){},652:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(73),l=a.n(c),o=a(202),i=a.n(o),u=a(320),m=a(8),s=a(675),d=a(653),f=a(53),p=a(668),E=a(19),g=a(36),b=a(20),h=a.n(b),v=(a(453),a(677)),O=a(671),j=a(673),S=a(4),y=a.n(S),k=function(e){return{className:y()("item",{active:e})}},C=function(e){var t=e.isPartiallyCurrent;return k(t)},w=function(e){var t=e.isCurrent;return k(t)},x=function(e){return"".concat("/schedule-checker").concat(e)},M=function(e,t){return{result:Math.floor(e/t),remainder:e%t}},I=function(e){var t=M(e,3600),a=t.result,n=t.remainder,r=a,c=M(n,60);return a=c.result,n=c.remainder,[r>0?"".concat(r," hours"):"",a>0?"".concat(a," minutes"):"","".concat(n," seconds")].join(" ")},F=function(e,t,a){return t(parseInt(e.target.value,10)||a)},A=function(e){if(!e)return{};var t=h()("config")||{},a=t.setup||Object(E.c)(e.getSetupProps()),n=t.model||Object(E.c)(e.getModelProps()),r=t.scrambling||Object(E.c)(e.getScramblingProps()),c=e.loadConfig(Object(E.b)(e.MapStringInt,a),Object(E.b)(e.MapStringInt,n),Object(E.b)(e.MapStringInt,r));return c!==e.ErrorKind.SUCCESS?(console.error("Could not load local config: ".concat(e.errorMessage(c))),{mapSetup:Object(E.c)(e.getSetupProps()),mapModel:Object(E.c)(e.getModelProps()),mapScrambling:Object(E.c)(e.getScramblingProps())}):{mapSetup:a,mapModel:n,mapScrambling:r}},T=function(e){return h()("config",e)},_=function(){h()("config",{}),document.location.reload()},N=function(){h.a.clear(),window.location=x("/")},P=a(64),B=Object({NODE_ENV:"production",PUBLIC_URL:"/schedule-checker",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_WCA_URL,R=function(){return B||h()("staging")},W=function(){return B||(R()?"https://staging.worldcubeassociation.org":"https://www.worldcubeassociation.org")},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(W()).concat(e)},D=function(e){return U("/api/v0".concat(e))},L=function(e){return D("/competitions".concat(e))},z=function(){return h()("token")||""},G=function(){var e,t=window.location.origin,a=new URLSearchParams({client_id:R()?"example-application-id":"3A9BGEPZcmf7CA1D77meVRMzFGT-CZq6-6oXyPgelMU",response_type:"token",redirect_uri:"".concat(t).concat("/schedule-checker"),scope:"public manage_competitions"});window.location=(e=a.toString(),U("/oauth/authorize?".concat(e)))},V=function(e){var t=e.user,a=e.userLoading;return r.a.createElement(v.a,{pointing:!0,secondary:!0},r.a.createElement(g.a,{to:x("/"),getProps:w},"Home"),r.a.createElement(g.a,{to:x("/settings"),getProps:C},"Settings"),r.a.createElement(g.a,{to:x("/quick-simu"),getProps:C},"Quick simulation"),r.a.createElement(g.a,{to:x("/from-wcif"),getProps:w},"Check WCIF"),t&&r.a.createElement(g.a,{to:x("/competitions"),getProps:C},"My competitions"),a&&r.a.createElement(O.a,{className:"right"},r.a.createElement(f.a,{loading:!0,name:"spinner"})),t&&r.a.createElement(j.a,{item:!0,text:t.name,className:"right",simple:!0},r.a.createElement(j.a.Menu,null,r.a.createElement(j.a.Item,{onClick:N},"Sign out"))),!t&&!a&&r.a.createElement("a",{href:"#",className:"item right",onClick:G},"Sign in with the WCA"))},q=a(669),Y=a(679),H=a(672),J=a(680),K=a(681),Q=a(22),Z=a.n(Q),$=a(205),X=a.n($),ee=(a(577),function(e){var t=e.saveAction,a=e.hasChanges,c=e.simulator,l=e.onFileSelected,o=Object(n.useRef)(null);return r.a.createElement(j.a,{item:!0,icon:"cogs",className:"right"},r.a.createElement(j.a.Menu,null,r.a.createElement(j.a.Item,{onClick:t,disabled:!a},"Save settings"),r.a.createElement(j.a.Item,{onClick:_},"Reset settings to default"),r.a.createElement(j.a.Divider,null),r.a.createElement(j.a.Header,null,"Settings as YAML"),r.a.createElement(j.a.Item,{onClick:function(){return o.current.click()}},"Import",r.a.createElement("input",{type:"file",ref:o,accept:".yml,.yaml",style:{display:"none"},onChange:function(e){return l(e,o)}})),r.a.createElement(j.a.Item,{onClick:function(){return function(e){var t=A(e),a=t.mapSetup,n=t.mapModel,r=t.mapScrambling,c=X.a.safeDump({setup:a,model:n,scrambling:r}),l=new Blob([c],{type:"application/x-yaml"}),o=window.URL.createObjectURL(l),i=document.createElement("a");i.href=o,i.setAttribute("download","simulator-settings.yml"),document.body.appendChild(i),i.click()}(c)}},"Export")))}),te=function(e){var t=e.options,a=e.props,n=e.setProps;return r.a.createElement(q.a,{className:"settings-form"},r.a.createElement(Y.a,{doubling:!0,textAlign:"right",columns:3},Object.entries(t).map((function(e){var t=Object(m.a)(e,2),c=t[0],l=t[1];return r.a.createElement(Y.a.Column,{key:c},r.a.createElement(q.a.Input,{inline:!0,min:0,type:"number",label:r.a.createElement(H.a,{trigger:r.a.createElement("label",null,l.text),position:"left center"},l.desc),value:a[c]||0,onChange:function(e){return function(e,t){var r=Object(P.a)({},a);r[e]=parseInt(t,10)||0,n(r)}(c,e.target.value)}}))}))))},ae=function(e,t,a,n,r){var c=A(e),l=c.mapSetup,o=c.mapModel,i=c.mapScrambling;t(l),a(o),n(i);var u={setup:l,model:o,scrambling:i};r(u),T(u)},ne=function(e,t,a,n,r,c,l,o){T({}),e.loadConfig(Object(E.b)(e.MapStringInt,t),Object(E.b)(e.MapStringInt,a),Object(E.b)(e.MapStringInt,n)),ae(e,r,c,l,o)},re=function(e){var t=e.simulator,a=Object(n.useState)({}),c=Object(m.a)(a,2),l=c[0],o=c[1],i=Object(n.useState)({}),u=Object(m.a)(i,2),d=u[0],f=u[1],p=Object(n.useState)({}),b=Object(m.a)(p,2),h=b[0],O=b[1],j=Object(n.useState)({}),S=Object(m.a)(j,2),y=S[0],k=S[1];Object(n.useEffect)((function(){ae(t,o,f,O,k)}),[t,o,f,O,k]);var x=Object(n.useState)(null),M=Object(m.a)(x,2),I=M[0],F=M[1],A=!Z.a.isEqual(y.setup,l),T=!Z.a.isEqual(y.model,d),_=!Z.a.isEqual(y.scrambling,h),N=A||T||_;return r.a.createElement("div",null,r.a.createElement(J.a,null,"Simulator settings"),r.a.createElement(s.a,{color:"violet"},"All values are unsigned integers.",r.a.createElement("br",null),"All times are expressed in seconds."),I&&r.a.createElement(s.a,{negative:!0},"Error while loading the settings:",r.a.createElement("pre",null,I)),r.a.createElement(v.a,{attached:"top",pointing:!0,color:"violet"},r.a.createElement(g.a,{to:"",getProps:w},"Setup"," ",A?"*":""),r.a.createElement(g.a,{to:"model",getProps:C},"Model parameters"," ",T?"*":""),r.a.createElement(g.a,{to:"scrambling",getProps:C},"Scrambling costs"," ",_?"*":""),r.a.createElement(ee,{simulator:t,saveAction:function(){ne(t,l,d,h,o,f,O,k)},hasChanges:N,onFileSelected:function(e,a){F(null);var n=new FileReader;n.onload=function(e){!function(e){try{var a=X.a.safeLoad(e),n=Object(P.a)({setup:{},model:{},scrambling:{}},a);ne(t,n.setup,n.model,n.scrambling,o,f,O,k)}catch(r){F(r.message)}}(e.target.result),a.current.value=""},n.onerror=function(e){return F("Couldn't load the YAML file (".concat(e,")"))},n.readAsText(e.target.files[0])}})),r.a.createElement(K.a,{attached:"bottom"},r.a.createElement(g.b,null,r.a.createElement(te,{path:"/",default:!0,simulator:t,options:E.a.setup,props:l,setProps:o}),r.a.createElement(te,{path:"/model",simulator:t,options:E.a.model,props:d,setProps:f}),r.a.createElement(te,{path:"/scrambling",simulator:t,options:E.a.scrambling,props:h,setProps:O}))))},ce=a(65),le=a(670),oe=a(666),ie=a(60),ue=function(e){var t=e.val,a=e.setVal,n=e.options,c=Object(ie.a)(e,["val","setVal","options"]);return r.a.createElement(j.a,Object.assign({},c,{value:t,onChange:function(e,t){var n=t.value;return a(n)},options:n}))},me=function(e){var t=e.generated,a=e.setGenerated,c=Object(n.useState)(10),l=Object(m.a)(c,2),o=l[0],i=l[1],u=Object(n.useState)(15),s=Object(m.a)(u,2),f=s[0],p=s[1],E=Object(n.useState)(10),g=Object(m.a)(E,2),b=g[0],h=g[1],v=o>f?{content:"Max must be greater than min"}:null;return Object(n.useEffect)((function(){i(Z.a.min(t)||10),p(Z.a.max(t)||15)}),[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement(J.a,{as:"h4",textAlign:"center"},"Generate random times"),r.a.createElement("p",null,"The form below let you add some randomly generated number within"," ",r.a.createElement("em",null,"min")," ","and"," ",r.a.createElement("em",null,"max"),"."),r.a.createElement(q.a,null,r.a.createElement(q.a.Input,{inline:!0,min:1,type:"number",label:"Min",value:o,onChange:function(e){return F(e,i,o)}}),r.a.createElement(q.a.Input,{inline:!0,min:1,type:"number",label:"Max",value:f,error:v,onChange:function(e){return F(e,p,f)}}),r.a.createElement(q.a.Input,{inline:!0,min:1,type:"number",label:"Amount",value:b,onChange:function(e){return F(e,h,b)}}),r.a.createElement(d.a,{color:"violet",disabled:!!v,content:"Generate and append",onClick:function(){return a([].concat(Object(ce.a)(t),Object(ce.a)(function(e,t,a){return Array.from(Array(a)).map((function(){return Math.floor(Math.random()*(t-e+1))+e}))}(o,f,b))))}})))},se=Array.from(Array(10).keys()).map((function(e){return{text:e+1,key:e+1,value:e+1}})),de=function(e){var t=e.generated,a=e.setGenerated,c=Object(n.useState)(Z.a.max(t)||15),l=Object(m.a)(c,2),o=l[0],i=l[1],u=Object(n.useState)(1),s=Object(m.a)(u,2),f=s[0],p=s[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(J.a,{as:"h4",textAlign:"center"},"Add specific time(s)"),r.a.createElement("p",null,"You can add a specific time one or more time by using the form below."),r.a.createElement(q.a,{className:"mb-2"},r.a.createElement(q.a.Input,{inline:!0,min:1,type:"number",label:"Time",value:o,onChange:function(e){return F(e,i,o)}})),r.a.createElement("div",{className:"mb-2"},"I want to add this value"," ",r.a.createElement(ue,{inline:!0,scrolling:!0,val:f,setVal:p,options:se})," ","times."),r.a.createElement(d.a,{color:"violet",content:"Append",onClick:function(){return a([].concat(Object(ce.a)(t),Object(ce.a)(Array.from(Array(f)).map((function(){return o})))))}}))},fe=function(e){var t=e.times,a=e.setTimes,c=e.OpenButton,l=e.headerContent,o=Object(n.useState)(!1),i=Object(m.a)(o,2),u=i[0],s=i[1],f=Object(n.useState)([]),p=Object(m.a)(f,2),E=p[0],g=p[1],b=function(){return s(!0)},h=function(){return s(!1)};return Object(n.useEffect)((function(){g(t)}),[t,u]),r.a.createElement(r.a.Fragment,null,c?r.a.createElement(c,{onClick:b}):r.a.createElement(d.a,{primary:!0,onClick:b},"Generate group"),r.a.createElement(le.a,{open:u,centered:!1,onClose:h},r.a.createElement(le.a.Header,null,l?r.a.createElement(r.a.Fragment,null,l):r.a.createElement(r.a.Fragment,null,"Generate competitors for group")),r.a.createElement(le.a.Content,null,r.a.createElement("p",null,"Use this form to generate a population for the group. Each number represents the average time of one competitor, therefore if you want 20 competitors in the group you need to generate 20 numbers."),r.a.createElement("p",null,"There are"," ",E.length," ","competitors in the group currently:",r.a.createElement("br",null),r.a.createElement("code",null,E.join(", "))),r.a.createElement(K.a,{basic:!0},r.a.createElement(Y.a,{columns:2,relaxed:"very",className:"mb-2"},r.a.createElement(Y.a.Column,null,r.a.createElement(me,{generated:E,setGenerated:g})),r.a.createElement(Y.a.Column,null,r.a.createElement(de,{generated:E,setGenerated:g}))),r.a.createElement(oe.a,{vertical:!0},"Or")),r.a.createElement(d.a,{basic:!0,negative:!0,content:"Clear times",onClick:function(){return g([])}})),r.a.createElement(le.a.Actions,null,r.a.createElement(d.a.Group,null,r.a.createElement(d.a,{positive:!0,onClick:function(){a(E),h()},content:"Save"}),r.a.createElement(d.a.Or,null),r.a.createElement(d.a,{color:"black",onClick:h,content:"Discard"})))))},pe=function(e){var t=e.times,a=e.setTimes,c=Object(n.useState)(!1),l=Object(m.a)(c,2),o=l[0],i=l[1];return r.a.createElement("div",{className:"times-details"},r.a.createElement(fe,{times:t,setTimes:a,OpenButton:function(e){var t=e.onClick;return r.a.createElement(d.a,{color:"violet",content:"Set group times",onClick:t,compact:!0})}}),r.a.createElement(d.a,{onClick:function(){return i(!o)},compact:!0},o?r.a.createElement(r.a.Fragment,null,"Hide details."):r.a.createElement(r.a.Fragment,null,"Show average times.")),o&&r.a.createElement(K.a,null,r.a.createElement("code",null,t.join(", "))))},Ee=a(663),ge=[{id:"333",name:"3x3x3 Cube",preferred_format:"a",rank:10},{id:"222",name:"2x2x2 Cube",preferred_format:"a",rank:20},{id:"444",name:"4x4x4 Cube",preferred_format:"a",rank:30},{id:"555",name:"5x5x5 Cube",preferred_format:"a",rank:40},{id:"666",name:"6x6x6 Cube",preferred_format:"m",rank:50},{id:"777",name:"7x7x7 Cube",preferred_format:"m",rank:60},{id:"333bf",name:"3x3x3 Blindfolded",preferred_format:"3",rank:70},{id:"333fm",name:"3x3x3 Fewest Moves",preferred_format:"m",rank:80},{id:"333oh",name:"3x3x3 One-Handed",preferred_format:"a",rank:90},{id:"clock",name:"Clock",preferred_format:"a",rank:110},{id:"minx",name:"Megaminx",preferred_format:"a",rank:120},{id:"pyram",name:"Pyraminx",preferred_format:"a",rank:130},{id:"skewb",name:"Skewb",preferred_format:"a",rank:140},{id:"sq1",name:"Square-1",preferred_format:"a",rank:150},{id:"444bf",name:"4x4x4 Blindfolded",preferred_format:"3",rank:160},{id:"555bf",name:"5x5x5 Blindfolded",preferred_format:"3",rank:170},{id:"333mbf",name:"3x3x3 Multi-Blind",preferred_format:"3",rank:180},{id:"333ft",name:"3x3x3 With Feet",preferred_format:"a",rank:996},{id:"magic",name:"Magic",preferred_format:"a",rank:997},{id:"mmagic",name:"Master Magic",preferred_format:"a",rank:998},{id:"333mbo",name:"3x3x3 Multi-Blind Old Style",preferred_format:"3",rank:999}],be={};ge.forEach((function(e){be[e.id]=e}));var he=[];ge.forEach((function(e){e.rank<900&&!["333fm","333mbf"].includes(e.id)&&he.push(e.id)}));var ve={official:ge.filter((function(e){return e.rank<900})),forSimulation:ge.filter((function(e){return he.includes(e.id)})),byId:be,simulatedId:he},Oe=ve.forSimulation.map((function(e){return{text:e.name,key:e.id,value:e.id}})),je=function(e){var t=e.event,a=e.setEvent,n=Object(ie.a)(e,["event","setEvent"]);return r.a.createElement(ue,Object.assign({},n,{val:t,setVal:a,options:Oe}))},Se=["Runners","JudgesRun"],ye=Se[0],ke=Se.map((function(e){return{text:e,key:e,value:e}})),Ce=function(e){var t=e.model,a=e.setModel,n=Object(ie.a)(e,["model","setModel"]);return r.a.createElement(ue,Object.assign({},n,{val:t,setVal:a,options:ke}))},we=function(e){var t=e.simulator,a=e.times,c=Object(n.useState)("333"),l=Object(m.a)(c,2),o=l[0],i=l[1],u=Object(n.useState)(ye),s=Object(m.a)(u,2),f=s[0],p=s[1],g=Object(n.useState)(""),b=Object(m.a)(g,2),h=b[0],v=b[1],O=Object(n.useState)(10),j=Object(m.a)(O,2),S=j[0],y=j[1],k=Object(n.useState)(14),C=Object(m.a)(k,2),w=C[0],x=C[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(J.a,null,"Quick staff optimizer"),r.a.createElement("div",{className:"opt-content"},r.a.createElement("div",{className:"inputs"},r.a.createElement(Ee.a,{min:3,type:"number",label:"Total staff",value:w,onChange:function(e){return F(e,x,w)}}),r.a.createElement(Ee.a,{min:1,type:"number",label:"Stations",value:S,onChange:function(e){return F(e,y,S)}})),r.a.createElement("p",null,"Given I have"," ",w," ","staff and at most"," ",S," ","stations available, I want to get the shortest time for this group."),r.a.createElement("div",null,"This group is for"," ",r.a.createElement(je,{event:o,setEvent:i,inline:!0,scrolling:!0})," ","and my staff will be using the"," ",r.a.createElement(Ce,{model:f,setModel:p,inline:!0})," ","system throughout the group.")),r.a.createElement(d.a,{primary:!0,className:"run-simu",content:"Run it!",onClick:function(){var e=Object(E.d)(t.VectorTime,a),n=new t.MapStringInt,r=t.optimizeStaff(o,e,S,w,n,f),c=r.Err,l=r.BestResult,i=r.Judges,u=r.Runners,m=r.Scramblers;if(c!==t.ErrorKind.SUCCESS)v("An error occurred during the simulation: ".concat(t.errorMessage(c)));else{var s="The best group took ".concat(I(l),","),d="using ".concat(i," judges, ").concat(m," scramblers, and ").concat(u," runners. ");v("".concat(s," ").concat(d))}}}),r.a.createElement("p",null,h))},xe=function(e){var t=e.simulator,a=e.times,c=Object(n.useState)("333"),l=Object(m.a)(c,2),o=l[0],i=l[1],u=Object(n.useState)(ye),f=Object(m.a)(u,2),p=f[0],g=f[1],b=Object(n.useState)(""),h=Object(m.a)(b,2),v=h[0],O=h[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(J.a,null,"Quick group simulation"),r.a.createElement(s.a,{compact:!0,color:"brown"},"You can adjust the number of judges/scramblers/runners, as well as the miscramble or extra rate in the settings."),r.a.createElement("div",null,"I want to simulate this group for"," ",r.a.createElement(je,{event:o,setEvent:i,inline:!0,scrolling:!0})," ","and my staff will be using the"," ",r.a.createElement(Ce,{model:p,setModel:g,inline:!0})," ","system throughout the group."),r.a.createElement(d.a,{primary:!0,className:"run-simu",content:"Run it!",onClick:function(){var e=Object(E.d)(t.VectorTime,a),n=new t.MapStringInt,r=t.simuGroup(o,e,n,p),c=r.Err,l=r.Value;c!==t.ErrorKind.SUCCESS?O("An error occurred during the simulation: ".concat(t.errorMessage(c))):O("The group took ".concat(I(l),"."))}}),r.a.createElement("p",null,v))},Me=(a(646),[]),Ie=function(e){var t=e.simulator,a=Object(n.useState)(Me),c=Object(m.a)(a,2),l=c[0],o=c[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(J.a,null,"Group setup"),r.a.createElement("div",null,"There are currently"," ",l.length," ","competitors in the group.",r.a.createElement(pe,{times:l,setTimes:function(e){Me=e,o(e)}})),r.a.createElement(xe,{simulator:t,times:l}),r.a.createElement(we,{simulator:t,times:l}))},Fe={data:null,lastFetched:null},Ae=function(){var e=new URLSearchParams(window.location.search);e.has("staging")&&!R()&&(h.a.clear(),h()("staging",!0),document.location.reload()),e.has("prod")&&R()&&(h.a.clear(),h()("staging",!1),document.location.reload())},Te=function(e,t){var a=Object(n.useState)(Object(P.a)({},Fe)),r=Object(m.a)(a,2),c=r[0],l=r[1],o=Object(n.useState)(!0),i=Object(m.a)(o,2),u=i[0],s=i[1],d=Object(n.useState)(null),f=Object(m.a)(d,2),p=f[0],E=f[1],g=Object(n.useCallback)((function(){s(!0),E(null),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=z();return 0===a.length?new Promise((function(){throw new Error("Oauth token empty, please log in.")})):fetch(e,Object(P.a)({},t,{headers:new Headers({Authorization:"Bearer ".concat(a),"Content-Type":"application/json"})})).then((function(e){if(!e.ok)throw new Error(e.statusText);return e})).then((function(e){return e.json()}))}(t).then((function(t){var a={data:t,lastFetched:Date.now()};l(a),h()(e,a)})).catch((function(e){E(e.message)})).finally((function(){return s(!1)}))}),[e,t,l,E]);return Object(n.useEffect)((function(){var t=h()(e)||Object(P.a)({},Fe);t.lastFetched?(l(t),s(!1)):g()}),[e,g]),{loadedData:c,loading:u,error:p,sync:g}},_e=function(e){var t=e.loading,a=e.sync,n=e.lastFetched,c=r.a.createElement(f.a,{link:!0,name:"sync",size:"small",loading:t,onClick:a});return r.a.createElement(r.a.Fragment,null,n?r.a.createElement(H.a,{trigger:c,content:"Last fetched on ".concat(new Date(n).toLocaleString()),size:"small",wide:!0,position:"bottom center"}):c)},Ne=function(e){var t=e.error;return r.a.createElement(s.a,{negative:!0},"Something wrong happened when loading the data:",r.a.createElement("pre",null,t),"Your authentification token may have expired, you can try to"," ",r.a.createElement(d.a,{primary:!0,compact:!0,size:"tiny",onClick:G,content:"sign in"})," ","again.",r.a.createElement("br",null),"If the issue persists, it most likely means the WCA website is unreachable. or the WCA website is unreachable.")},Pe=a(678),Be=a(667),Re=a(676),We=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Pe.a,{active:!0,inverted:!0},r.a.createElement(Be.a,{active:!0,inverted:!0})),r.a.createElement(Re.a,null,r.a.createElement(Re.a.Line,null),r.a.createElement(Re.a.Line,null)))},Ue=(a(647),function(e){var t=e.competitions;return r.a.createElement(v.a,{vertical:!0,fluid:!0,className:"competitions-list"},t.map((function(e){return r.a.createElement(g.a,{key:e.id,to:e.id,className:y()("item",{"not-announced":!e.announced_at})},e.name)})))}),De=new URLSearchParams({managed_by_me:!0,start:new Date(Date.now()-290304e5).toISOString()}),Le=function(){var e=Te("competitions.index",L("?".concat(De.toString()))),t=e.loadedData,a=e.loading,n=e.error,c=e.sync,l=t.data,o=t.lastFetched;return r.a.createElement(r.a.Fragment,null,r.a.createElement(J.a,{className:"my-comps"},"My recent competitions",r.a.createElement(_e,{loading:a,sync:c,lastFetched:o})),n&&r.a.createElement(Ne,{error:n}),a&&r.a.createElement(K.a,null,r.a.createElement(We,null)),!a&&l&&r.a.createElement(Ue,{competitions:l}))},ze=a(662),Ge=function(e){var t=e.match(/^(\w+)(?:-r(\d+))?(?:-g(\d+))?(?:-a(\d+))?(?:-(\w+))?$/),a=Object(m.a)(t,6),n=a[1],r=a[2],c=a[3],l=a[4],o=a[5];return{eventId:"other"===n?null:n,roundNumber:r?parseInt(r,10):null,groupNumber:c?parseInt(c,10):null,attemptNumber:l?parseInt(l,10):null,otherActivity:o}},Ve=function(e,t){var a=Ge(t),n=a.eventId,r=a.roundNumber,c="".concat(n,"-r").concat(r),l=e.find((function(e){return e.id===n}));return l?l.rounds.find((function(e){return e.id===c})):null},qe=function(e,t,a){var n=Ve(t.events,a),r=n.cutoff,c=n.timeLimit,l={};if(c){var o=c.centiseconds;l.time_limit=Math.floor(o/100)}if(r){var i=r.attemptResult;l.cutoff=Math.floor(i/100)}return Object(E.b)(e.MapStringInt,l)},Ye=a(674),He=function(e){var t=e.activity,a=e.compWcif,c=e.maxStaff,l=e.maxStations,o=e.times,i=e.selectedModel,u=e.simulator,s=Object(n.useState)(null),p=Object(m.a)(s,2),g=p[0],b=p[1],h=Object(n.useState)(!1),v=Object(m.a)(h,2),O=v[0],j=v[1],S=Object(n.useState)(null),y=Object(m.a)(S,2),k=y[0],C=y[1];return Object(n.useEffect)((function(){return b(null)}),[t,a,c,l,o,i,u]),r.a.createElement(r.a.Fragment,null,k&&r.a.createElement("pre",null,k),!k&&O&&r.a.createElement(f.a,{name:"spinner",loading:!0}),!k&&!O&&g&&r.a.createElement("div",null,r.a.createElement(J.a,{as:"h5",content:"Best configuration found"}),"Time:"," ",I(g.BestResult),r.a.createElement("br",null),"Judges:"," ",g.Judges,r.a.createElement("br",null),"Scramblers:"," ",g.Scramblers,r.a.createElement("br",null),"Runners:"," ",g.Runners),!k&&!O&&!g&&r.a.createElement(d.a,{circular:!0,compact:!0,icon:"calculator",onClick:function(){j(!0),function(e,t,a,n,r,c,l,o,i){if(0!==r.length){var u=e.activityCode,m=Ge(u).eventId,s=Object(E.d)(i.VectorTime,r),d=qe(i,t,u),f=i.optimizeStaff(m,s,n,a,d,c);f.Err!==i.ErrorKind.SUCCESS?o("An error occurred during the simulation: ".concat(i.errorMessage(f.Err))):l(f)}else l(null)}(t,a,c,l,o,i,b,C,u),j(!1)}}))},Je=function(e,t,a){var n=e.map((function(e){return t[e][a]})),r=0,c=(n=n.filter((function(e){return void 0===e&&(r+=1),void 0!==e})))[n.length-1];if(c)for(var l=0;l<r;l+=1)n.push(c);return n},Ke=function(e,t){return Math.floor((new Date(t).getTime()-new Date(e).getTime())/1e3)},Qe=function(e){var t,a=e.index,c=e.simulator,l=e.selectedModel,o=e.activity,i=e.pbMap,u=e.groupsById,s=e.accuracyArray,f=e.setAccuracyArray,p=e.compWcif,g=e.maxStaff,b=e.maxStations,h=Object(n.useState)(null),v=Object(m.a)(h,2),O=v[0],j=v[1],S=Object(n.useState)(null),y=Object(m.a)(S,2),k=y[0],C=y[1],w=Object(n.useState)([]),x=Object(m.a)(w,2),M=x[0],F=x[1],A=o.name,T=o.startTime,_=o.endTime;return Object(n.useEffect)((function(){!function(e,t,a,n,r,c,l){if(0!==e.length){var o=a.activityCode,i=Ge(o).eventId,u=Object(E.d)(t.VectorTime,e),m=qe(t,n,o),s=t.simuGroup(i,u,m,l),d=s.Err,f=s.Value;d!==t.ErrorKind.SUCCESS?c("An error occurred during the simulation: ".concat(t.errorMessage(d))):r(f)}else r(null)}(M,c,o,p,C,j,l)}),[M,c,o,p,C,j,l]),Object(n.useEffect)((function(){!function(e,t,a,n,r){if(void 0!==n){var c=r.startTime,l=r.endTime,o=Ke(c,l),i=Math.abs(n-o),u=Math.round(i/o*100),m=Object(ce.a)(t);m[e]=u<10||i<120,Z.a.isEqual(t,m)||a(m)}}(a,s,f,k,o)}),[a,s,f,k,o]),Object(n.useEffect)((function(){0===M.length&&function(e,t,a,n,r){var c=e.id,l=e.activityCode,o=Ge(l),i=o.eventId,u=o.roundNumber,m=o.groupNumber;if(i&&!Z.a.isEmpty(n)&&!Z.a.isEmpty(r)&&u)if(1!==u){var s=Ve(a.events,"".concat(i,"-r").concat(u-1)).advancementCondition;if(s){var d=s.type,f=s.level;if(d&&["ranking","percent"].includes(d)){var p="".concat(i,"-r").concat(u),E=0,g=[];a.schedule.venues.forEach((function(e){e.rooms.forEach((function(e){e.activities.forEach((function(e){e.activityCode.startsWith(p)?E+=e.childActivities.length:e.activityCode.startsWith("".concat(i,"-r1"))&&g.push.apply(g,Object(ce.a)(e.childActivities.map((function(e){return e.id}))))}))}))}));var b=Z.a.sortBy(Z.a.flatMap(g,(function(e){return Je(n[e],r,i)}))),h="ranking"===d?f:Math.floor(b.length*f/100),v=Math.floor(h/E),O=(m-1)*v,j=O+(m===E?h-(E-1)*v:v)+1;t(b.slice(O,j))}}}else t(Je(n[c]||[],r,i))}(o,F,p,u,i)}),[M.length,o,F,p,u,i]),r.a.createElement(Ye.a.Item,null,r.a.createElement(oe.a,{horizontal:!0},r.a.createElement(J.a,{as:"h4"},A)),r.a.createElement("p",null,"Scheduled for"," ",I(Ke(T,_)),"."),r.a.createElement(J.a,{as:"h5",content:"Simulation",className:"mb-2"}),r.a.createElement(fe,{times:M,setTimes:F,OpenButton:(t=M.length,function(e){var a=e.onClick;return r.a.createElement(d.a,{size:"tiny",compact:!0,content:"Manage times (".concat(t,")"),className:"mb-2",onClick:a})}),headerContent:"Times for ".concat(A)}),r.a.createElement("p",null,O&&r.a.createElement(r.a.Fragment,null,O),!O&&k&&r.a.createElement(r.a.Fragment,null,"Simulation took",I(k),"."),!O&&!k&&r.a.createElement(r.a.Fragment,null,"No simulation result yet")),r.a.createElement(He,{activity:o,compWcif:p,maxStaff:g,maxStations:b,times:M,selectedModel:l,simulator:c}))},Ze=(a(648),a(649),function(e){var t=e.id,a=Object(ie.a)(e,["id"]);return r.a.createElement(f.a,Object.assign({className:"cubing-icon event-".concat(t)},a))}),$e=function(e){var t=e.simulator,a=e.selectedModel,c=e.compWcif,l=e.activity,o=e.pbMap,i=e.groupsById,u=e.maxStaff,s=e.maxStations,d=l.activityCode,f=l.name,p=l.childActivities,E=Ge(d).eventId,g=Object(n.useState)(p.map((function(){}))),b=Object(m.a)(g,2),h=b[0],v=b[1],O="black";return h.every((function(e){return e}))?O="green":h.some((function(e){return void 0!==e}))&&(O="orange"),r.a.createElement(Y.a.Column,{key:l.id},r.a.createElement(K.a,{color:O},r.a.createElement(J.a,{as:"h3"},E&&r.a.createElement(Ze,{id:E}),r.a.createElement(J.a.Content,null,f)),r.a.createElement(Ye.a,{relaxed:!0},Z.a.sortBy(p,["startTime"]).map((function(e,n){return r.a.createElement(Qe,{index:n,key:e.id,activity:e,color:O,accuracyArray:h,setAccuracyArray:v,compWcif:c,pbMap:o,groupsById:i,simulator:t,selectedModel:a,maxStaff:u,maxStations:s})})))))},Xe=["judges","scramblers","runners","extra_rate","miscramble_rate"],et=function(e){var t=e.setupSettings,a=e.selectedModel,n=e.setSelectedModel,c=e.maxStaff,l=e.setMaxStaff;return r.a.createElement(K.a,{color:"teal"},r.a.createElement(J.a,{as:"h2"},"Settings"),r.a.createElement("p",null,'You can adjust them in the "settings" section, except for the system used that you can select below.'),r.a.createElement(q.a,null,r.a.createElement(Y.a,{columns:3,className:"mb-2"},r.a.createElement(Y.a.Row,null,Xe.map((function(e){return r.a.createElement(Y.a.Column,{key:e},r.a.createElement(q.a.Field,{inline:!0},r.a.createElement("label",null,E.a.setup[e].text),":"," ",t[e]))})))),r.a.createElement("div",null,r.a.createElement(q.a.Input,{inline:!0,label:"Max number of staff for each group:",type:"number",min:3,size:"small",value:c,onChange:function(e){return l(parseInt(e.target.value,10)||0)}})),r.a.createElement("div",null,"I want to use the"," ",r.a.createElement(Ce,{model:a,setModel:n,inline:!0})," ","system."),r.a.createElement("p",null,"Click on"," ",r.a.createElement(f.a,{name:"calculator"})," ","to compute the shortest time to run the group, and to display which staff assignments were used.")))},tt=function(e){var t=e.simulator,a=e.compWcif,c=a.schedule,l=Object(n.useState)({}),o=Object(m.a)(l,2),i=o[0],u=o[1],s=Object(n.useState)({}),d=Object(m.a)(s,2),f=d[0],p=d[1],E=Object(n.useState)(!0),g=Object(m.a)(E,2),b=g[0],h=g[1],v=A(t).mapSetup,O=Object(n.useState)(ye),S=Object(m.a)(O,2),y=S[0],k=S[1],C=Object(n.useState)(v.judges+v.scramblers+v.runners),w=Object(m.a)(C,2),x=w[0],M=w[1],I=Z.a.flatMap(c.venues,(function(e){return e.rooms.map((function(t){return{key:t.id,value:t.id,text:"".concat(t.name," in ").concat(e.name)}}))})),F=Object(n.useState)(null),T=Object(m.a)(F,2),_=T[0],N=T[1],P=function(e,t,a){var n=Z.a.flatMap(e.venues,(function(e){return e.rooms})).find((function(e){return e.id===t}));if(!n)return[];var r=Z.a.sortBy(n.activities.filter((function(e){return!a||ve.simulatedId.includes(Ge(e.activityCode).eventId)})),["startTime"]);return Z.a.groupBy(r,(function(e){return t=new Date(e.startTime),"".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate());var t}))}(c,_,b);return Object(n.useEffect)((function(){!function(e,t,a){var n={},r={};e.persons.forEach((function(e){if(e.registrantId){var t={};e.personalBests.forEach((function(e){t[e.eventId]=Math.floor(e.best/100)})),n[e.registrantId]=t,e.assignments.forEach((function(t){"competitor"===t.assignmentCode&&(r[t.activityId]||(r[t.activityId]=[]),r[t.activityId].push(e.registrantId))}))}})),t(n),a(r)}(a,u,p);var e=a.schedule.venues[0];if(e){var t=e.rooms[0];t&&N(t.id)}}),[a]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.a,{columns:2,stackable:!0},r.a.createElement(Y.a.Column,null,r.a.createElement(j.a,{onChange:function(e,t){var a=t.value;return N(a)},options:I,value:_,selection:!0,className:"mb-2"}),r.a.createElement("p",null,"You can review the schedule for that room below.")),r.a.createElement(Y.a.Column,null,r.a.createElement(ze.a,{toggle:!0,label:"Show only event that can be simulated",checked:b,onChange:function(){return h(!b)}})),r.a.createElement(Y.a.Column,{width:16},r.a.createElement(et,{setupSettings:v,selectedModel:y,setSelectedModel:k,maxStaff:x,setMaxStaff:M}))),Z.a.map(P,(function(e,c){return r.a.createElement(n.Fragment,{key:c},r.a.createElement(oe.a,{horizontal:!0},r.a.createElement(J.a,{as:"h2"},new Date(c).toDateString())),r.a.createElement(Y.a,{columns:3,stackable:!0},Z.a.sortBy(e,["startTime"]).map((function(e){return r.a.createElement($e,{key:e.id,activity:e,compWcif:a,pbMap:i,groupsById:f,simulator:t,selectedModel:y,maxStaff:x,maxStations:v.judges})}))))})))},at=function(e){var t=e.competitionId,a=e.simulator,n=Te("competitions.".concat(t),L("/".concat(t,"/wcif"))),c=n.loadedData,l=n.loading,o=n.error,i=n.sync,u=c.data,m=c.lastFetched;return r.a.createElement(r.a.Fragment,null,r.a.createElement(J.a,{as:"h1",className:"my-comps"},u?u.name:t,r.a.createElement(_e,{loading:l,sync:i,lastFetched:m})),o&&r.a.createElement(Ne,{error:o}),l&&r.a.createElement(K.a,null,r.a.createElement(We,null)),!l&&u&&r.a.createElement(tt,{compWcif:u,simulator:a}))},nt=(a(650),function(e){var t=e.simulator,a=Object(n.useState)(null),c=Object(m.a)(a,2),l=c[0],o=c[1],i=Object(n.useState)(h()("local-wcif")),u=Object(m.a)(i,2),s=u[0],p=u[1],E=Object(n.useRef)(null);return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"file",ref:E,accept:".json",style:{display:"none"},onChange:function(e){return function(e,t,a,n){n(null),a(null);var r=new FileReader;r.onload=function(e){try{var r=JSON.parse(e.target.result);a(r),h()("local-wcif",r)}catch(l){n(l.message)}t.current.value=""},r.onerror=function(e){return n("Couldn't load the JSON file (".concat(e,")"))},r.readAsText(e.target.files[0])}(e,E,p,o)}}),r.a.createElement(J.a,{as:"h1"},"Check schedule from WCIF",r.a.createElement("span",{className:"mr-2"}),r.a.createElement(d.a,{icon:!0,className:"upload-wcif",compact:!0,size:"tiny",labelPosition:"right",onClick:function(){return E.current.click()}},r.a.createElement(f.a,{name:"upload"}),"Upload WCIF")),l&&r.a.createElement(Ne,{error:l}),s&&r.a.createElement(r.a.Fragment,null,r.a.createElement(J.a,{as:"h2"},s.name),r.a.createElement(tt,{simulator:t,compWcif:s})))}),rt=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a.Header,null,"Loading required content"),"Please wait while the page is loading a required module.")},ct=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"The loading of the module timed out. It&pos;s likely that there was an error and that your browser does not support WebAssembly."),r.a.createElement("p",null,"This module is necessary for this application, it is pointless to show you anything more than this error message at this point.",r.a.createElement("br",null),"Feel free to check this website to make sure your browser is supported."),r.a.createElement(d.a,{href:"https://caniuse.com/#feat=wasm",target:"_blank",secondary:!0},"Check browser compatibility"))},lt=function(e){var t=e.simulator,a=e.loading;return r.a.createElement(r.a.Fragment,null,!t&&r.a.createElement(s.a,{icon:!0,color:a?"teal":"red"},a&&r.a.createElement(f.a,{name:"circle notched",loading:!0}),r.a.createElement(s.a.Content,null,a?r.a.createElement(rt,null):r.a.createElement(ct,null))))},ot=function(){return r.a.createElement("div",null,"This page is a work in progress and most likely won't do what you expect.",r.a.createElement("br",null),"You should not use it.",r.a.createElement("br",null),"Come back later.")},it=function(){return r.a.createElement("p",null,"Oups, it's a 404")},ut=function(e){var t=e.children;return r.a.createElement(r.a.Fragment,null,t)};var mt=function(){var e=Object(n.useState)(void 0),t=Object(m.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(!0),o=Object(m.a)(l,2),d=o[0],f=o[1],b=h()("currentUser"),v=b?b.data:null,O=v?v.me:null,j=Te("currentUser",D("/me")),S=j.loadedData,y=j.loading,k=S.data,C=k?k.me:null;b&&C&&O.id!==C.id&&function(){var e=h()("staging"),t=h()("token"),a=h()("currentUser");h.a.clear(),h()("currentUser",a),h()("token",t),h()("staging",e)}();var w=function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(E.e)((function(){c(t),f(!1)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){w(),Ae(),setTimeout((function(){return f(!1)}),3e3)}),[]),Object(n.useEffect)((function(){A(a)}),[a]),r.a.createElement(p.a,null,r.a.createElement(lt,{simulator:a,loading:d}),a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(V,{user:C,userLoading:y}),R()&&r.a.createElement(s.a,{size:"small",color:"pink"},"You're not currently using the WCA's production data."),r.a.createElement(g.b,{basepath:"/schedule-checker"},r.a.createElement(ot,{path:"/"}),r.a.createElement(re,{simulator:a,path:"settings/*"}),r.a.createElement(Ie,{simulator:a,path:"/quick-simu"}),r.a.createElement(nt,{simulator:a,path:"/from-wcif"}),!y&&C&&r.a.createElement(ut,{path:"competitions"},r.a.createElement(Le,{path:"/"}),r.a.createElement(at,{path:":competitionId",simulator:a})),r.a.createElement(it,{default:!0}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(651);!function(){var e,t=window.location.hash.replace(/^#/,""),a=new URLSearchParams(t);if(a.has("access_token")){window.location.hash="",e=a.get("access_token"),h()("token",e);var n=h()("currentUser");n&&(n.lastFetched=null,h()("currentUser",n))}}(),l.a.render(r.a.createElement(mt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[358,1,2]]]);
//# sourceMappingURL=main.17438ae8.chunk.js.map